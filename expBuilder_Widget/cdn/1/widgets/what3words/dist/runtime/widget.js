System.register(["jimu-core","jimu-arcgis","jimu-ui"],(function(e,t){var o={},i={},s={};return{setters:[function(e){o.React=e.React,o.css=e.css,o.getAppStore=e.getAppStore,o.jsx=e.jsx},function(e){i.JimuMapViewComponent=e.JimuMapViewComponent,i.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules},function(e){s.Button=e.Button,s.Icon=e.Icon,s.Popper=e.Popper}],execute:function(){e((()=>{var e={541:e=>{e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M.5 9a.5.5 0 0 1-.5-.5V1a1 1 0 0 1 1-1h6.5a.5.5 0 0 1 0 1H1v7.5a.5.5 0 0 1-.5.5ZM3 3v8h8V3H3Zm0-1h8a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1Z" fill="#000" fill-rule="nonzero"></path></svg>'},721:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" xml:space="preserve"><path d="M0 0h6v1.5H2.542L6 4.861v1.055L5.916 6H4.857L1.5 2.545V6H0V0zm10 0v1.5h3.457L10 4.861v1.055l.084.084h1.059L14.5 2.545V6H16V0h-6zm4.5 13.455L11.143 10h-1.059l-.084.084v1.055l3.457 3.361H10V16h6v-6h-1.5v3.455zM4.857 10 1.5 13.455V10H0v6h6v-1.5H2.542L6 11.139v-1.055L5.916 10H4.857z"></path></svg>'},341:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAACxLAAAsSwGlPZapAAAFGmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0MzUyLCAyMDIwLzAxLzMwLTE1OjUwOjM4ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMSAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjAtMDQtMDdUMTA6NDY6NTQrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTA0LTA3VDEwOjUzOjUyKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTA0LTA3VDEwOjUzOjUyKzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjJmMWMxNGFiLTU4NDktNDVmYi05ODBjLWFjYTc5OTc3ZThiYyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyZjFjMTRhYi01ODQ5LTQ1ZmItOTgwYy1hY2E3OTk3N2U4YmMiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyZjFjMTRhYi01ODQ5LTQ1ZmItOTgwYy1hY2E3OTk3N2U4YmMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjJmMWMxNGFiLTU4NDktNDVmYi05ODBjLWFjYTc5OTc3ZThiYyIgc3RFdnQ6d2hlbj0iMjAyMC0wNC0wN1QxMDo0Njo1NCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+G6jKbAAAB6dJREFUeJztm2tsVMcZhp+ZOXuxMfFtfUnMpeQmoCBw3bh2EzA0MRRoAjiJqNKkatVKVav+qpQ//K0qtZV6U9WLKqSqlaq0BDuhrSxupgRsDE2oKVRJqtAUAyYYe9c3vJeze2b64xwMSe2lkfdwWnXf1dFq95ud837veefb2TmzwhjDbFjQuPUysHDW4P8WpqYHuhfPFbTyfHCRD2SCQHm+oMwTmywwkaCQN498AvxfoChA0ASCRlGAoAkEjaIAQRMIGkUBgiYQNIoCBE0gaBQFCJpA0PBdACEEQgqSV4dJXhtBSIkQwo0pieNokpeukoyPIa1bv86FUqQzNskr75GcTr4vVkj4LoAWgunEBG2b22jd0EJy8gbaiznZHJlMhu2ffZLVaz9KZnzSFUwIcqkUllJs2r6J+roY9vS0L/x8FyA1PMpHli3m2K+/z8mXfsyihjpSiXGEEKQvXmFH+2O8+pNv8seffwtHQDKVRgOZwSFe/NIuDu75Dj/a/XXs63G0nn31aj7wVQAhBIwmeH7HZgAydhbb0SAlWe364MvPbgPgemIc7CxKSTKpNNTG+OpzT818jpyDN3IKCl8FSNtZqK6ko/0xAH7zhx6G//om0fKF2BNTVK58iCdamwD4ZddB9EicaCSMHonT0tJIQ20MgF90doOlZmpHIeGrAE58jOVNq2hc8SAArxzpBSGwpISRONvWNxMJhzDGsP9YP1RV4BhgOsXOxx8FYPDqML39A4iaal84+ieAEDA+wc6NnwQgMTHFkf4zUBvDdhywLJ5uXw/An06fZej83wlVVpBOp+G+Op7Z5MY6D52AoWtES6K+0PRNgIxtQ3Ulu7ZsAGB/Tx/pfwwSLSt17b/iQT697hEAOg8dh+kkYUthhuO0tjRy/+J7Aeg6ehKiEeQcy/fzhW8COKMJVjatZs3yBwDYd+gESIklBIzE2bLuEaKRMAC/f+00VFVgAFIpOjz7Xxy6Rl//GURdDH/S90sAIWBiih0bWwGIj0/Sc/INqIthaw2WRccT6wDX/lfOvUWoyrN/Qz1Pe/bfd/A4XPHP/uCTAK79q3h2cxsArx7pJfPuJaILXPtXLH+AbW2fAGDvgWMz9tfDcVqb17JsUT0AXT19UBr1tVL70rczOsaKplWs9ap/V08fKOXZP8HWdc1EI2Gv+p+C6qpZ7d9/+iyiNsZct+8KgcILIASMT7Fzg2v/xMQkPX1vQG3MnfxYio52z/6nBnjv/NuEqspJp1z7d2xyY10+V/+bKLgAGTsLsUqeuWn/nj4y714murCUzKRr/63rmwHYd+g4JNOu/UcStDSv5f5FbvXvPNoHpSW+z9UL3r8zmmBF0yoaV3r2P9wHSmIJCSMJtqxrpiQaAWD/a6chVokxQDJFx6fcOcPg1WFOnhpA1Fb7an8osADGGEil+cKT7QBMTE179q/GzmYRZQt4/jOPA3Ck/y9cPfsmocpy0jeSLHx4Gbu2bASg63Cv79X/JgovgJR8fNXDAHQdPkH6wkWiZQuw7SzinjLamtcA8KtXDkImQ1gpdCpFTV0NS+6rBWBv91FY4L/9If/+gA8NKSVWVQW7f7CHbW0t7NnXjVVXgxKCkmiE7I0kX9z9XVYsW8LLB44RXroIYwyRygouXxriG9/+GaGQ4tSZvxFpqPfd/gAizw6RCeCeD9uhDFncuB6H8UmIVVFWVY7O5ryVIcmNoWuQSqMa6ikpjaJzDkJKjNYkB4dAayJLGwhZFlrrO5/wzpicHuiec5NEwdeZdDZHaWU5VJbPvAZ3eBjHobS+5lbbnOPGvERLlzbcihUm+TuiuCgaNIGgURQgaAJBoyhA0ASCRlGAoAkEjaIAQRMIGkUBgiYQNIoC5ImF7xoLf5E3j3wC+L8edXeQN4986wHNgCosl5sQ4NvNrn+Dky+YT4DXC8nCIBHe5hiBA4jb3jMYz4wGgbh74hR+ReiDcBMzWNg4CEAg0BjUaqAGGBGY8xoHgcFCkMOaaec3fPwWcJNVZAmTIkwK0GjkZoPVaxDnwPQYxDmDOmmQm8GZaavIzvThJ3wRwDW1gyKFIg04OEgEcjvIAwYevb29gVZQBwRqew4FGBQ2ChuDQft4nXwZAhYWrgwSB4k73nWVQXdKtLtyHB+H66NQG6OsugKyOQyhTgdiAj1uvCGgsBFIHBR4w6mQ8EHamxXeHdF4AoB8wSAUgD02yZIlDXztxa+weEkD9tjMP9sUyM+DRCAAhfCS9qsw+uAAg0NulvdFowByjoM9NsHvXv4pLWtX8sJT7bS2fw5KIlhK4aCaZvv2dQX4L90naD7wmKNVFtzajqV4+5+XAdxnqbwrDgLs2c8hZo5CFsZ8d4b+805mLDtX8gKD3qXRv5VC4tg2WQMfW/kQA29dwDIGFQmhjUCSe06iXzJzJCm8OYPGynO+92N6oHvO2LwdIBC3CSBnPbw2eyVi0BiDikYxxvD6iT+jtUaVRDFGINGDAr3XTUzPcRjA8eYI83fCvGqAwaBQWFh5rO9CIIwN7Zpcr3Sc2mgkDPe6d4ON46CR1xVOe4isM9fVv9WXJockh5p3cbyrP4cNvCOQawTmh2AuABPABYH5nsBZY+Cdu8kH4F8uRvBg2ETTaQAAAABJRU5ErkJggg=="},826:e=>{"use strict";e.exports=i},891:e=>{"use strict";e.exports=o},726:e=>{"use strict";e.exports=s}},t={};function a(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,a),s.exports}a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var n={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(n),a.d(n,{default:()=>c});var e=a(891),t=a(826);const o=a(341),i={_widgetLabel:"what3words",x:"Longitude",y:"Latitude",copy:"Copy",copySuccessMessage:"Copy Successful",zoomTo:"Zoom To"};var s=a(726),r=function(e,t,o,i){return new(o||(o=Promise))((function(s,a){function n(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(n,r)}l((i=i.apply(e,t||[])).next())}))};const l=a(541),p=a(721);class c extends e.React.PureComponent{constructor(s){var a,n,l;super(s),this.zoomScale=5e3,this.nls=e=>this.props.intl.formatMessage({id:e,defaultMessage:i[e]}),this.onZoomClick=()=>{if(this.mapView.graphics.length>0){const e=this.mapView.graphics.getItemAt(0);this.mapView.goTo({center:e.geometry,scale:this.zoomScale})}},this.onCopyClick=()=>{window.getSelection&&window.getSelection().removeAllRanges(),navigator.clipboard.writeText(this.state.what3words),this.setState({isCopyMessageOpen:!0}),setTimeout((()=>{window.getSelection&&window.getSelection().removeAllRanges(),this.setState({isCopyMessageOpen:!1})}),500)},this.onActiveViewChange=e=>{e&&(this.mapView=e.view,this.setState({jimuMapView:e}),this.setState({w3wLocator:this.state.w3wLocator}),this.mapView.on("click",(e=>r(this,void 0,void 0,(function*(){this.mapView.graphics.removeAll(),this.mapView.popup.autoOpenEnabled=!1;const i=yield(s=e.mapPoint,s?(0,t.loadArcGISJSAPIModules)(["esri/Graphic","esri/symbols/PictureMarkerSymbol"]).then((e=>{let t,i=null;[i,t]=e;const a=new t({width:25,height:25,url:o});return new i({geometry:s,symbol:a})})):Promise.resolve(null));var s;this.setState({latitude:e.mapPoint.latitude.toFixed(4),longitude:e.mapPoint.longitude.toFixed(4)}),this.props.config.displayPopupMessage&&this.mapView.popup.open({title:`Reverse geocode for ${this.state.latitude}, ${this.state.longitude}`,location:e.mapPoint}),((e,o)=>o?(0,t.loadArcGISJSAPIModules)(["esri/rest/locator"]).then((i=>{const[s]=i;return(e=>e?(0,t.loadArcGISJSAPIModules)(["esri/geometry/Point"]).then((t=>{const[o]=t;return new o({longitude:e.longitude,latitude:e.latitude,spatialReference:{wkid:4326}})})):Promise.resolve(null))(o).then((t=>s.locationToAddress(e,{location:t},{query:{}}).then((e=>Promise.resolve(e.address)),(e=>(console.error(e.message),e.message+" - Check your Locator URL")))))})):Promise.resolve(null))(this.state.w3wLocator,e.mapPoint).then((o=>r(this,void 0,void 0,(function*(){this.setState({what3words:o});const s=yield((e,o)=>e?(console.log("getMapLabelGraphic function"),console.log(o),(0,t.loadArcGISJSAPIModules)(["esri/Graphic"]).then((t=>{let i=null;return[i]=t,new i({geometry:e,symbol:{type:"text",text:"///"+o,font:{size:12,weight:"bold"},horizontalAlignment:"left",kerning:!0,rotated:!1,color:[225,31,38,1],haloColor:"#0A3049",haloSize:"1px",xoffset:12,yoffset:-5}})}))):Promise.resolve(null))(e.mapPoint,this.state.what3words);this.mapView.popup.content=`what3words address: ///${o}`,this.mapView.graphics.add(i),this.mapView.graphics.add(s),this.mapView.set({center:e.mapPoint})})))).catch((e=>{console.log("error: "+e),this.mapView.popup.content="No address was found for this location",this.mapView.graphics.removeAll()}))})))))},this.componentWillUnmount=()=>{console.log("Component will unmount"),this._isMounted=!1,this.mapView.graphics.removeAll()};let p="";(null===(n=null===(a=this.props.config)||void 0===a?void 0:a.addressSettings)||void 0===n?void 0:n.geocodeServiceUrl)?p=this.props.config.addressSettings.geocodeServiceUrl:this.props.portalSelf&&this.props.portalSelf.helperServices&&this.props.portalSelf.helperServices.geocode&&this.props.portalSelf.helperServices.geocode.length>0&&this.props.portalSelf.helperServices.geocode[0].url&&(p=this.props.portalSelf.helperServices.geocode[0].url),this._isMounted=!1,this.isRTL=!1;const c=(0,e.getAppStore)().getState();this.isRTL=null===(l=null==c?void 0:c.appContext)||void 0===l?void 0:l.isRTL,this.state={w3wLocator:p,JimuMapView:null,latitude:"",longitude:"",what3words:null,isCopyMessageOpen:!1}}componentDidMount(){console.log("Component did mount"),this._isMounted=!0}componentDidUpdate(e){var t,o;console.log("Component did update"),(null===(t=e.config.addressSettings)||void 0===t?void 0:t.geocodeServiceUrl)!==(null===(o=this.props.config.addressSettings)||void 0===o?void 0:o.geocodeServiceUrl)&&this.setState({w3wLocator:this.props.config.addressSettings.geocodeServiceUrl})}render(){var o;return(0,e.jsx)("div",{css:(this.props.theme,e.css`
  
      .w3wBlock {
        display:block;
        white-space:nowrap;
        overflow:hidden;
      }
      .w3wRed {
        color:#E11F26;
      }
      .w3wCoords {
        background:#0A3049;
        width:100%;
        color:#fff;
        padding: 5px;
      }
      .w3wCoordsProp {
        display:inline-block;
        margin-right:20px;
        margin-left: 5px;
      }
      .w3wCoordsFirstCol {
        display:inline-block;
        margin-right:5px;
        font-weight: 700;
      }
      .float-right {
        float:right;
      }
      .actionButton {
        margin: 2px 2px 0px 2px;
      }
      .actionButton {
        color: #E11F26;
      }
      .actionButton:disabled{
        cursor: default;
      }
    `),className:"widget-starter jimu-widget"},(0,e.jsx)("h5",null,"Reverse Geocode with your what3words locator"),{}.hasOwnProperty.call(this.props,"useMapWidgetIds")&&this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length&&(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:null===(o=this.props.useMapWidgetIds)||void 0===o?void 0:o[0],onActiveViewChange:this.onActiveViewChange}),this.props.config.displayCopyButton&&(0,e.jsx)(s.Button,{type:"tertiary","aria-label":this.nls("copy"),"aria-disabled":!this.state.what3words,title:this.nls("copy"),className:"float-right actionButton",icon:!0,size:"sm",active:this.state.isCopyMessageOpen,disabled:!this.state.what3words,id:"refCopy"+this.props.id,onClick:this.onCopyClick.bind(this)},(0,e.jsx)(s.Icon,{icon:l,size:"17"})),this.props.config.displayZoomButton&&(0,e.jsx)(s.Button,{type:"tertiary","aria-label":this.nls("zoomTo"),"aria-disabled":!this.state.what3words,title:this.nls("zoomTo"),className:"float-right actionButton",icon:!0,size:"sm",onClick:this.onZoomClick.bind(this),disabled:!this.state.what3words},(0,e.jsx)(s.Icon,{icon:p,size:"17"})),(0,e.jsx)("h3",{className:"w3wBlock"},(0,e.jsx)("span",{className:"w3wRed"},"///"),this.state.what3words),this.props.config.displayCoordinates&&(0,e.jsx)("div",{className:"w3wCoords"},(0,e.jsx)("div",{className:"w3wCoordsProp"},(0,e.jsx)("span",{className:"w3wRed w3wCoordsFirstCol"},i.y,":"),(0,e.jsx)("span",null,this.state.latitude)),(0,e.jsx)("div",{className:"w3wCoordsProp"},(0,e.jsx)("span",{className:"w3wRed w3wCoordsFirstCol"},i.x,":"),(0,e.jsx)("span",null,this.state.longitude))),this.state.isCopyMessageOpen&&(0,e.jsx)(s.Popper,{open:this.state.isCopyMessageOpen,version:0,placement:"bottom",showArrow:!0,reference:"refCopy"+this.props.id,offset:[0,0]},(0,e.jsx)("div",{className:"p-2"},this.nls("copySuccessMessage"))))}}})(),n})())}}}));